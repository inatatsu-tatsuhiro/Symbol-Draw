{"version":3,"sources":["components/elements/ShareModal/index.tsx","components/elements/Canvas/index.tsx","features/draw/Presenter.tsx","features/draw/index.tsx","libs/Symbol/ImageIO.ts"],"names":["baselink","Component","open","setOpen","txHash","getI18nText","useI18n","copy","React","useCallback","navigator","clipboard","writeText","onClose","SPaper","variant","component","button","url","Wrapper","Provider","value","size","MLeft","onClick","console","log","getApostilleFile","then","imgs","bufs","split","map","img","Buffer","from","styled","Paper","stageRef","saveFile","image","sharePrev","useState","tool","setTool","setSize","color","setColor","lines","setLines","isDrawing","useRef","FlexDiv","FlexCol","IconButton","SBsPenFill","Wrap","Slider","defaultValue","valueLabelDisplay","max","min","marks","label","onChange","e","target","StageDiv","width","height","onMouseDown","current","pos","getStage","getPointerPosition","points","x","y","onMousemove","point","lastLine","length","concat","splice","onMouseup","style","border","marginTop","ref","line","i","stroke","strokeWidth","tension","lineCap","globalCompositeOperation","CustomSketchPicker","onChangeComplete","hex","Wraper","margin","Tooltip","title","Button","endIcon","div","SketchPicker","marginLeft","props","Page","hash","Image","setImage","openPM","setOpenPM","setTxHash","isLoading","setIsLoading","error","setError","useEffect","getFile","src","catch","Canvas","toDataURL","h","ShareModal","Container","useParams","G_HASH","NODE","EPOCH","a","Promise","resolve","reject","checkConfirmed","tx","TransferTransaction","JSON","parse","message","payload","data","innerTxJoin","timer","setInterval","checkUnConfirmed","setTimeout","clearInterval","previousHash","join","transactionHttp","RepositoryFactoryHttp","createTransactionRepository","res","rej","getTransaction","TransactionGroup","Unconfirmed","toPromise","Confirmed","repositoryFactory","agtx","innerTxs","innerTransactions","inTx","base64img","gameMode","signer","Account","createFromPrivateKey","NetworkType","TEST_NET","acc","Address","createFromRawAddress","array","MSG_SIZE","Math","floor","arr","slice","push","txs","agtxs","hashes","create","Deadline","PlainMessage","toAggregate","publicAccount","AggregateTransaction","createComplete","UInt64","fromUint","signedTx","sign","announce","subscribe","err","stringify","version","name","mode","substr","st"],"mappings":"8RAmBMA,EAAW,mDAgFFC,IA/EqB,SAAC,GAA+B,IAA7BC,EAA4B,EAA5BA,KAAMC,EAAsB,EAAtBA,QAASC,EAAa,EAAbA,OAC5CC,EAAgBC,cAAhBD,YAEFE,EAAOC,IAAMC,aAAY,WAC7BC,UAAUC,UAAUC,UAAUR,KAC7B,CAACA,IASJ,OACE,cAAC,IAAD,CAAOF,KAAMA,EAAMW,QAAS,kBAAMV,GAAQ,IAA1C,SACE,eAACW,EAAD,WACE,cAAC,IAAD,CAAYC,QAAQ,KAAKC,UAAU,MAAnC,SACGX,EAAY,YAEf,eAAC,IAAD,WACE,cAAC,IAAD,CAAUY,QAAM,EAAhB,SACE,cAAC,IAAD,CAAoBC,IAAG,UAAKlB,EAAL,mBAAwBI,GAA/C,SACE,eAACe,EAAD,WACE,cAAC,IAAYC,SAAb,CAAsBC,MAAO,CAAEC,KAAM,QAArC,SACE,cAAC,IAAD,MAEF,cAAC,IAAD,CAAQC,MAAM,OAAd,SACE,cAAC,IAAD,CAAYR,QAAQ,KAAKC,UAAU,MAAnC,SACGX,EAAY,4BAMvB,cAAC,IAAD,CAAUY,QAAM,EAAhB,SACE,cAAC,IAAD,CAAqBC,IAAG,UAAKlB,EAAL,mBAAwBI,GAAhD,SACE,eAACe,EAAD,WACE,cAAC,IAAYC,SAAb,CAAsBC,MAAO,CAAEC,KAAM,QAArC,SACE,cAAC,IAAD,MAEF,cAAC,IAAD,CAAQC,MAAM,OAAd,SACE,cAAC,IAAD,CAAYR,QAAQ,KAAKC,UAAU,MAAnC,SACGX,EAAY,6BAMvB,cAAC,IAAD,CAAUY,QAAM,EAAhB,SACE,eAACE,EAAD,CAASK,QAASjB,EAAlB,UACE,cAAC,IAAYa,SAAb,CAAsBC,MAAO,CAAEC,KAAM,QAArC,SACE,cAAC,IAAD,MAEF,cAAC,IAAD,CAAQC,MAAM,OAAd,SACE,cAAC,IAAD,CAAYR,QAAQ,KAAKC,UAAU,MAAnC,SACGX,EAAY,4BAKrB,cAAC,IAAD,CAAUY,QAAM,EAAhB,SACE,eAACE,EAAD,CAASK,QAvDD,WAChBC,QAAQC,IAAI,aACZC,YAAiBvB,GAAQwB,MAAK,SAACC,GAC7B,IAAMC,EAAOD,EAAKE,MAAM,KAAKC,KAAI,SAACC,GAAD,OAASC,EAAOC,KAAKF,EAAK,aAC3DR,QAAQC,IAAI,OAAQI,OAmDd,UACE,cAAC,IAAYV,SAAb,CAAsBC,MAAO,CAAEC,KAAM,QAArC,SACE,cAAC,IAAD,MAEF,cAAC,IAAD,CAAQC,MAAM,OAAd,SACE,cAAC,IAAD,CAAYR,QAAQ,KAAKC,UAAU,MAAnC,SACGX,EAAY,oCAY/B,IAAMS,EAASsB,YAAOC,IAAPD,CAAH,wPAcNjB,EAAUiB,YAAO,MAAPA,CAAH,8I,mOCmEEnC,EAjKqB,SAAC,GAK9B,IAJLqC,EAII,EAJJA,SACAC,EAGI,EAHJA,SACAC,EAEI,EAFJA,MACAC,EACI,EADJA,UAEA,EAAwBjC,IAAMkC,SAAS,OAAvC,mBAAOC,EAAP,KAAaC,EAAb,KACA,EAAwBpC,IAAMkC,SAAS,GAAvC,mBAAOpB,EAAP,KAAauB,EAAb,KACA,EAA0BrC,IAAMkC,SAAS,WAAzC,mBAAOI,EAAP,KAAcC,EAAd,KACA,EAA0BvC,IAAMkC,SAAgB,IAAhD,mBAAOM,EAAP,KAAcC,EAAd,KACMC,EAAY1C,IAAM2C,QAAO,GAEvB9C,EAAgBC,cAAhBD,YA8DR,OACE,qCACE,eAAC+C,EAAD,WACE,eAACC,EAAD,WACE,cAACC,EAAA,EAAD,CAAYtC,UAAU,OAAOQ,QAAS,kBAAMoB,EAAQ,QAApD,SACY,QAATD,EAAiB,cAAC,IAAD,IAAgB,cAAC,IAAD,MAE1B,QAATA,EACC,cAACY,EAAD,CAAYT,MAAOA,IAEnB,cAACS,EAAD,CAAYT,MAAM,aAGtB,eAACO,EAAD,WACE,cAACC,EAAA,EAAD,CAAYtC,UAAU,OAAOQ,QAAS,kBAAMoB,EAAQ,WAApD,SACY,WAATD,EAAoB,cAAC,IAAD,IAAmB,cAAC,IAAD,MAE1C,cAACY,EAAD,CAAYT,MAAM,aAEpB,cAACU,EAAD,UACE,cAACC,EAAA,EAAD,CACE,aAAW,eACXC,aAAc,EACdC,kBAAkB,OAClBC,IAAK,GACLC,IAAK,EACLC,MAtFI,CACZ,CACEzC,MAAO,EACP0C,MAAO,OAET,CACE1C,MAAO,EACP0C,MAAO,OAET,CACE1C,MAAO,EACP0C,MAAO,OAET,CACE1C,MAAO,GACP0C,MAAO,QAET,CACE1C,MAAO,GACP0C,MAAO,QAET,CACE1C,MAAO,GACP0C,MAAO,SAgEDC,SAAU,SAACC,GAAD,OAAYpB,EAAQoB,EAAEC,OAAO7C,eAI7C,eAAC+B,EAAD,WACE,cAACe,EAAD,UACE,cAAC,IAAD,CACEC,MAAO,IACPC,OAAQ,IACRC,YArEc,SAACL,GACvBf,EAAUqB,SAAU,EACpB,IAAMC,EAAMP,EAAEC,OAAOO,WAAWC,qBAChCzB,EAAS,GAAD,mBACHD,GADG,CAEN,CACEL,OACAgC,OAAQ,CAACH,EAAII,EAAGJ,EAAIK,GACpB/B,QACAxB,YA6DIwD,YAxDc,SAACb,GAEvB,GAAKf,EAAUqB,QAAf,CAGA,IACMQ,EADQd,EAAEC,OAAOO,WACHC,qBACdM,EAAWhC,EAAMA,EAAMiC,OAAS,GACtCD,EAASL,OAASK,EAASL,OAAOO,OAAO,CAACH,EAAMH,EAAGG,EAAMF,IACzD7B,EAAMmC,OAAOnC,EAAMiC,OAAS,EAAG,EAAGD,GAClC/B,EAASD,EAAMkC,YA+CPE,UA1CY,WACpBlC,EAAUqB,SAAU,GA0CZc,MAAO,CACLC,OAAQ,QACRC,UAAW,QAEbC,IAAKlD,EAVP,SAWE,eAAC,IAAD,WACa,OAAVE,GAAkB,cAAC,IAAD,CAAQA,MAAOA,IACjCQ,EAAMhB,KAAI,SAACyD,EAAMC,GAAP,OACT,cAAC,IAAD,CAEEf,OAAQc,EAAKd,OACbgB,OAAQF,EAAK3C,MACb8C,YAAaH,EAAKnE,KAClBuE,QAAS,GACTC,QAAQ,QACRC,yBACgB,WAAdN,EAAK9C,KAAoB,kBAAoB,eAP1C+C,aAcf,cAACM,EAAD,CACElD,MAAOA,EACPmD,iBAvEqB,SAACnD,GAC5BC,EAASD,EAAMoD,WAyEb,eAACC,EAAD,WACE,cAAC,IAAD,CAAOC,OAAO,OAAd,SACE,cAACC,EAAA,EAAD,CAASC,MAAOjG,EAAY,uBAA5B,SACE,cAACkG,EAAA,EAAD,CAAQxF,QAAQ,WAAWyF,QAAS,cAAC,IAAD,IAAYhF,QAASe,EAAzD,mCAKJ,cAAC,IAAD,CAAO6D,OAAO,OAAd,SACE,cAACC,EAAA,EAAD,CAASC,MAAOjG,EAAY,wBAA5B,SACE,cAACkG,EAAA,EAAD,CAAQxF,QAAQ,WAAWyF,QAAS,cAAC,IAAD,IAAYhF,QAASiB,EAAzD,2CAYNW,EAAUhB,IAAOqE,IAAV,0EAKPpD,EAAUjB,IAAOqE,IAAV,yEAKPtC,EAAW/B,IAAOqE,IAAV,0DAGRjD,EAAOpB,IAAOqE,IAAV,kEAKJT,EAAqB5D,YAAOsE,IAAPtE,CAAqB,CAC9CmD,UAAW,OACXoB,WAAY,SAGRpD,EAAanB,YAAO,MAAPA,CAAH,gEAGA,SAACwE,GAAD,OAAWA,EAAM9D,SAI3BqD,EAAS/D,YAAO,MAAPA,CAAH,0E,mBC1IGyE,EA/DgB,SAAC,GAAc,IAAZC,EAAW,EAAXA,KAChC,EAA0BtG,IAAMkC,SAA2B,IAAIqE,OAA/D,mBAAOvE,EAAP,KAAcwE,EAAd,KACM1E,EAAW9B,IAAM2C,OAA2B,MAElD,EAAwB3C,IAAMkC,UAAS,GAAvC,mBAAOxC,EAAP,KAAaC,EAAb,KACA,EAA4BK,IAAMkC,UAAS,GAA3C,mBAAOuE,EAAP,KAAeC,EAAf,KACA,EAA4B1G,IAAMkC,SAAS,IAA3C,mBAAOtC,EAAP,KAAe+G,EAAf,KACA,EAAkC3G,IAAMkC,UAAS,GAAjD,mBAAO0E,EAAP,KAAkBC,EAAlB,KACA,EAA0B7G,IAAMkC,UAAS,GAAzC,mBAAO4E,EAAP,KAAcC,EAAd,KA6BA,GApBA/G,IAAMgH,WAAU,WACd,GAAa,KAATV,EAGF,OAFArF,QAAQC,IAAI,iBACZ2F,GAAa,GAGf5F,QAAQC,IAAI,UAAWoF,GACvBW,YAAQX,GACLlF,MAAK,SAACK,GACLoF,GAAa,GACb,IAAM3B,EAAI,IAAIqB,MACdrB,EAAEgC,IAAMzF,EACR+E,EAAStB,MAEViC,OAAM,WACLlG,QAAQC,IAAI,QACZ6F,GAAS,QAEZ,CAACT,IAEAQ,EACF,OAAO,4DAGT,GAAIF,EACF,OAAO,qDAOT,OACE,gCACE,cAACQ,EAAD,CACErF,SA1CO,WACX,GAAyB,OAArBD,EAASiC,QAAb,CACA,IAAMtC,EAAMK,EAASiC,QAAQsD,YAC7BpG,QAAQC,IAAIO,GACZM,YAASN,EAAK,aAAc6E,GAAMlF,MAAK,SAACkG,GAAD,OAAOX,EAAUW,MACxD3H,GAAQ,KAsCJmC,SAAUA,EACVE,MAAOA,EACPC,UAVY,WAChByE,GAAU,MAWR,cAACa,EAAA,EAAD,CAAY7H,KAAMA,EAAMC,QAASA,EAASC,OAAQA,IAClD,cAAC2H,EAAA,EAAD,CAAY7H,KAAM+G,EAAQ9G,QAAS+G,EAAW9G,OAAQ0G,Q,OC7D7CkB,UALc,WAC3B,IAAQlB,EAASmB,cAATnB,KACR,OAAO,cAAC,EAAD,CAAMA,KAAMA,GAAQ,O,uLCQvBoB,EACJ,mEACIC,EAAO,2CACPC,EAAQ,WAKDX,EAAO,uCAAG,WAAOX,GAAP,SAAAuB,EAAA,+EACd,IAAIC,SAAQ,SAACC,EAASC,GAC3BC,EAAe3B,GACZlF,MAAK,SAAC8G,GACL,GAAIA,aAAcC,sBAAqB,CACrC,IAAMb,EAAYc,KAAKC,MAAMH,EAAGI,QAAQC,SAASC,KACjDT,EAAQU,EAAYnB,QAGvBH,OAAM,WACL,IAAMuB,EAAQC,aAAY,WACxBC,EAAiBtC,GACdlF,MAAK,WACJyH,YAAW,WACTZ,EAAe3B,GACZlF,MAAK,SAAC8G,GAEL,GADAY,cAAcJ,GACVR,aAAcC,sBAAqB,CACrC,IAAMb,EAAYc,KAAKC,MAAMH,EAAGI,QAAQC,SAASC,KACjDT,EAAQU,EAAYnB,QAGvBH,OAAM,WACLa,EAAO,YAEV,QAEJb,OAAM,WACLlG,QAAQC,IAAI,gBAEf,YA9BY,2CAAH,sDAkCPC,EAAgB,uCAAG,WAAOmF,GAAP,SAAAuB,EAAA,4DAClB,GAEZ,IAAIC,SAAQ,SAACC,EAASC,GACpBC,EAAe3B,GAAMlF,MAAK,SAAC8G,GACrBA,aAAcC,uBAChBlH,QAAQC,IAAI,OAAQkH,KAAKC,MAAMH,EAAGI,QAAQC,gBANlB,kBAUvB,IAAIT,SAAQ,SAACC,EAASC,GAC3BC,EAAe3B,GACZlF,MAAK,SAAC8G,GACL,GAAIA,aAAcC,sBAAqB,CACrC,IAAMb,EAAYc,KAAKC,MAAMH,EAAGI,QAAQC,SAASC,KACjDvH,QAAQC,IACN,gBACAkH,KAAKC,MAAMH,EAAGI,QAAQC,SAASQ,cAEjChB,EAAQ,CAACU,EAAYnB,GAAImB,EAAYnB,IAAI0B,KAAK,UAGjD7B,OAAM,WACL,IAAMuB,EAAQC,aAAY,WACxBC,EAAiBtC,GACdlF,MAAK,WACJyH,YAAW,WACTZ,EAAe3B,GACZlF,MAAK,SAAC8G,GAEL,GADAY,cAAcJ,GACVR,aAAcC,sBAAqB,CACrC,IAAMb,EAAYc,KAAKC,MAAMH,EAAGI,QAAQC,SAASC,KACjDT,EAAQ,CAACU,EAAYnB,GAAImB,EAAYnB,IAAI0B,KAAK,UAGjD7B,OAAM,WACLa,EAAO,YAEV,QAEJb,OAAM,WACLlG,QAAQC,IAAI,gBAEf,YA3CqB,2CAAH,sDAgDvB0H,EAAmB,SAACtC,GACxB,IACM2C,EADoB,IAAIC,wBAAsBvB,GACVwB,8BAC1C,OAAO,IAAIrB,SAAQ,SAACsB,EAAKC,GACvBJ,EACGK,eAAehD,EAAMiD,mBAAiBC,aACtCC,YACArI,MAAK,WACJiI,OAEDlC,OAAM,WACLiC,WAKFnB,EAAiB,SAAC3B,GACtB,IACM2C,EADoB,IAAIC,wBAAsBvB,GACVwB,8BAC1C,OAAO,IAAIrB,SAAQ,SAACsB,EAAKC,GACvBJ,EACGK,eAAehD,EAAMiD,mBAAiBG,WACtCD,YACArI,MAAK,SAAC8G,GACLkB,EAAIlB,MAELf,OAAM,WACLkC,WAIFZ,EAAW,uCAAG,WAAOnC,GAAP,mBAAAuB,EAAA,6DACZ8B,EAAoB,IAAIT,wBAAsBvB,GAC9CsB,EAAkBU,EAAkBR,8BACtCX,EAAO,GAHO,kBAKX,IAAIV,SAAQ,SAACC,GAClBkB,EACGK,eAAehD,EAAMiD,mBAAiBG,WACtCD,YACArI,MAAK,SAACwI,GACL,IADc,EACRC,EAAYD,EAA8BE,kBADlC,cAEKD,GAFL,IAEd,2BAA6B,CAAC,IAAnBE,EAAkB,QAC3BvB,GAASuB,EAA6BzB,QAAQC,SAHlC,8BAKdR,EAAQS,UAdI,2CAAH,sDAmBJzG,EAAQ,uCAAG,WACtBiI,EACAC,EACAlB,GAHsB,2CAAAlB,EAAA,sDAWtB,IANMqC,EAASC,UAAQC,qBA3IvB,mEA2IoDC,cAAYC,UAC1DC,EAAMC,UAAQC,qBAClB,2CAEIC,EAAkB,GAClBC,EAAW,KACRzF,EAAI,EAAGA,GAAK0F,KAAKC,MAAMb,EAAUvF,OAASkG,GAAWzF,IACtD4F,EAAMd,EAAUe,MAAM7F,EAAIyF,GAAWzF,EAAI,GAAKyF,GACpDD,EAAMM,KAAKF,GAMPG,EAAM,GACNC,EAAQ,GACRC,EAAmB,GAGnBxB,EAAoB,IAAIT,wBAAsBvB,GAC9CsB,EAAkBU,EAAkBR,8BAEjCjE,EAAI,EA3BS,aA2BNA,EAAIwF,EAAMjG,QA3BJ,oBA6BdsF,EAAO5B,sBAAoBiD,OAC/BC,WAASD,OAAOxD,GAChB2C,EACA,GACAe,eAAaF,OAAOV,EAAMxF,IAC1BmF,cAAYC,UACZiB,YAAYrB,EAAOsB,eAErBP,EAAID,KAAKjB,GAEL7E,EAAI,MAAQ,IAAMA,IAAMwF,EAAMjG,OAAS,EAvCvB,wDA2CdmF,EAAO6B,uBAAqBC,eAChCL,WAASD,OAAOxD,GAChBqD,EACAZ,cAAYC,SACZ,GACAqB,SAAOC,SAAS,MAGZC,EAAW3B,EAAO4B,KAAKlC,EAAMlC,GAEnCuB,EAAgB8C,SAASF,GAAUG,WACjC,SAAC5H,GAAD,OAAOnD,QAAQC,IAAIkD,MACnB,SAAC6H,GAAD,OAAShL,QAAQ6F,MAAMmF,MAEzBf,EAAMF,KAAKa,GACXV,EAAOH,KAAKa,EAASvF,MAErBrF,QAAQC,IAAI,IAAK2K,GA5DG,QA2BY3G,IA3BZ,iDA+Df,IAAI4C,SAAQ,SAACC,GAClBc,YAAW,WAUT,IATA,IAAML,EAAOJ,KAAK8D,UAAU,CAC1BC,QAAS,EACTC,KAAM,cACNC,KAAMpC,EACNlB,aAAcA,EACdP,KAAM2C,EAAOnC,KAAK,OAGdnB,EAAI,GACD3C,EAAI,EAAGA,GAAK0F,KAAKC,MAAMrC,EAAK/D,OAASkG,GAAWzF,IACvD2C,EAAEmD,KAAKxC,EAAK8D,OAAOpH,EAAIyF,EAAUA,IAEnC,IAAMzC,EAAKC,sBAAoBiD,OAC7BC,WAASD,OAAOxD,GAChB2C,EACA,GACAe,eAAaF,OAAO5C,GACpB6B,cAAYC,SACZqB,SAAOC,SAAS,MAGZW,EAAKrC,EAAO4B,KAAK5D,EAAIR,GAE3BuB,EAAgB8C,SAASQ,GAAIP,WAC3B,SAAC5H,GAAD,OAAOnD,QAAQC,IAAIkD,MACnB,SAAC6H,GAAD,OAAShL,QAAQ6F,MAAMmF,MAEzBlE,EAAQwE,EAAGjG,QACV,SA7FiB,4CAAH,2D","file":"static/js/10.be23f34d.chunk.js","sourcesContent":["import { List, ListItem, Modal, Paper, Typography } from '@mui/material'\n\nimport { BsFacebook, BsTwitter } from 'react-icons/bs'\nimport { BiCopyAlt } from 'react-icons/bi'\nimport { FaFileDownload } from 'react-icons/fa'\nimport { TwitterShareButton, FacebookShareButton } from 'react-share'\nimport styled from '@emotion/styled'\nimport React, { Dispatch } from 'react'\nimport Spacer from '../../utils/Spacer'\nimport { IconContext } from 'react-icons/lib'\n\nimport { useI18n } from '../../../utils/useI18n'\nimport { getApostilleFile } from '../../../libs/Symbol/ImageIO'\n\nexport type Props = {\n  open: boolean\n  setOpen: Dispatch<boolean>\n  txHash: string\n}\nconst baselink = 'https://inatatsu-tatsuhiro.github.io/SymbolDraw/'\nconst Component: React.VFC<Props> = ({ open, setOpen, txHash }) => {\n  const { getI18nText } = useI18n()\n\n  const copy = React.useCallback(() => {\n    navigator.clipboard.writeText(txHash)\n  }, [txHash])\n\n  const apostille = () => {\n    console.log('apostille')\n    getApostilleFile(txHash).then((imgs) => {\n      const bufs = imgs.split(',').map((img) => Buffer.from(img, 'base64'))\n      console.log('bufs', bufs)\n    })\n  }\n  return (\n    <Modal open={open} onClose={() => setOpen(false)}>\n      <SPaper>\n        <Typography variant=\"h6\" component=\"div\">\n          {getI18nText('invite')}\n        </Typography>\n        <List>\n          <ListItem button>\n            <TwitterShareButton url={`${baselink}/canvas/${txHash}`}>\n              <Wrapper>\n                <IconContext.Provider value={{ size: '32px' }}>\n                  <BsTwitter />\n                </IconContext.Provider>\n                <Spacer MLeft=\"16px\">\n                  <Typography variant=\"h4\" component=\"div\">\n                    {getI18nText('share_twitter')}\n                  </Typography>\n                </Spacer>\n              </Wrapper>\n            </TwitterShareButton>\n          </ListItem>\n          <ListItem button>\n            <FacebookShareButton url={`${baselink}/canvas/${txHash}`}>\n              <Wrapper>\n                <IconContext.Provider value={{ size: '32px' }}>\n                  <BsFacebook />\n                </IconContext.Provider>\n                <Spacer MLeft=\"16px\">\n                  <Typography variant=\"h4\" component=\"div\">\n                    {getI18nText('share_facebook')}\n                  </Typography>\n                </Spacer>\n              </Wrapper>\n            </FacebookShareButton>\n          </ListItem>\n          <ListItem button>\n            <Wrapper onClick={copy}>\n              <IconContext.Provider value={{ size: '32px' }}>\n                <BiCopyAlt />\n              </IconContext.Provider>\n              <Spacer MLeft=\"16px\">\n                <Typography variant=\"h4\" component=\"div\">\n                  {getI18nText('share_clipboard')}\n                </Typography>\n              </Spacer>\n            </Wrapper>\n          </ListItem>\n          <ListItem button>\n            <Wrapper onClick={apostille}>\n              <IconContext.Provider value={{ size: '32px' }}>\n                <FaFileDownload />\n              </IconContext.Provider>\n              <Spacer MLeft=\"16px\">\n                <Typography variant=\"h4\" component=\"div\">\n                  {getI18nText('share_download')}\n                </Typography>\n              </Spacer>\n            </Wrapper>\n          </ListItem>\n        </List>\n      </SPaper>\n    </Modal>\n  )\n}\n\nexport default Component\nconst SPaper = styled(Paper)`\n  position: absolute;\n  top: 50%;\n  left: 50%;\n  width: 50vw;\n  transform: translate(-50%, -50%);\n  padding: 16px;\n\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n  align-items: center;\n`\n\nconst Wrapper = styled('div')`\n  display: flex;\n  flex-direction: row;\n  align-content: center;\n  align-items: center;\n  margin: 4px 8px;\n`\n","/* eslint-disable @typescript-eslint/no-explicit-any */\nimport React, { Ref } from 'react'\nimport { Stage, Layer, Line, Image as KImage } from 'react-konva'\nimport { SketchPicker } from 'react-color'\nimport Konva from 'konva'\nimport styled from '@emotion/styled'\n\nimport { BsPenFill, BsPen, BsEraserFill, BsEraser } from 'react-icons/bs'\nimport { Button, IconButton, Slider, Tooltip } from '@mui/material'\nimport { FiSend } from 'react-icons/fi'\nimport Space from '../../utils/Spacer'\nimport { useI18n } from '../../../utils/useI18n'\n\nexport type Props = {\n  stageRef: Ref<Konva.Stage>\n  saveFile: () => void\n  image: HTMLImageElement\n  sharePrev: () => void\n}\n\nconst Component: React.VFC<Props> = ({\n  stageRef,\n  saveFile,\n  image,\n  sharePrev,\n}) => {\n  const [tool, setTool] = React.useState('pen')\n  const [size, setSize] = React.useState(5)\n  const [color, setColor] = React.useState('#000000')\n  const [lines, setLines] = React.useState<any[]>([])\n  const isDrawing = React.useRef(false)\n\n  const { getI18nText } = useI18n()\n\n  const marks = [\n    {\n      value: 1,\n      label: '1pt',\n    },\n    {\n      value: 3,\n      label: '3pt',\n    },\n    {\n      value: 5,\n      label: '5pt',\n    },\n    {\n      value: 10,\n      label: '10pt',\n    },\n    {\n      value: 15,\n      label: '15pt',\n    },\n    {\n      value: 20,\n      label: '20pt',\n    },\n  ]\n\n  const handleMouseDown = (e: any) => {\n    isDrawing.current = true\n    const pos = e.target.getStage().getPointerPosition()\n    setLines([\n      ...lines,\n      {\n        tool,\n        points: [pos.x, pos.y],\n        color,\n        size,\n      },\n    ])\n  }\n\n  const handleMouseMove = (e: any) => {\n    // no drawing - skipping\n    if (!isDrawing.current) {\n      return\n    }\n    const stage = e.target.getStage()\n    const point = stage.getPointerPosition()\n    const lastLine = lines[lines.length - 1]\n    lastLine.points = lastLine.points.concat([point.x, point.y])\n    lines.splice(lines.length - 1, 1, lastLine)\n    setLines(lines.concat())\n  }\n  const handleChangeComplete = (color: any) => {\n    setColor(color.hex)\n  }\n  const handleMouseUp = () => {\n    isDrawing.current = false\n  }\n\n  return (\n    <>\n      <FlexDiv>\n        <FlexCol>\n          <IconButton component=\"span\" onClick={() => setTool('pen')}>\n            {tool === 'pen' ? <BsPenFill /> : <BsPen />}\n          </IconButton>\n          {tool === 'pen' ? (\n            <SBsPenFill color={color} />\n          ) : (\n            <SBsPenFill color=\"white\" />\n          )}\n        </FlexCol>\n        <FlexCol>\n          <IconButton component=\"span\" onClick={() => setTool('eraser')}>\n            {tool === 'eraser' ? <BsEraserFill /> : <BsEraser />}\n          </IconButton>\n          <SBsPenFill color=\"white\" />\n        </FlexCol>\n        <Wrap>\n          <Slider\n            aria-label=\"Custom marks\"\n            defaultValue={3}\n            valueLabelDisplay=\"auto\"\n            max={20}\n            min={1}\n            marks={marks}\n            onChange={(e: any) => setSize(e.target.value)}\n          />\n        </Wrap>\n      </FlexDiv>\n      <FlexDiv>\n        <StageDiv>\n          <Stage\n            width={500}\n            height={500}\n            onMouseDown={handleMouseDown}\n            onMousemove={handleMouseMove}\n            onMouseup={handleMouseUp}\n            style={{\n              border: 'solid',\n              marginTop: '10px',\n            }}\n            ref={stageRef}>\n            <Layer>\n              {image !== null && <KImage image={image} />}\n              {lines.map((line, i) => (\n                <Line\n                  key={i}\n                  points={line.points}\n                  stroke={line.color}\n                  strokeWidth={line.size}\n                  tension={0.5}\n                  lineCap=\"round\"\n                  globalCompositeOperation={\n                    line.tool === 'eraser' ? 'destination-out' : 'source-over'\n                  }\n                />\n              ))}\n            </Layer>\n          </Stage>\n        </StageDiv>\n        <CustomSketchPicker\n          color={color}\n          onChangeComplete={handleChangeComplete}\n        />\n      </FlexDiv>\n      <Wraper>\n        <Space margin=\"16px\">\n          <Tooltip title={getI18nText('tooltip_current_art')}>\n            <Button variant=\"outlined\" endIcon={<FiSend />} onClick={saveFile}>\n              Share Current Art\n            </Button>\n          </Tooltip>\n        </Space>\n        <Space margin=\"16px\">\n          <Tooltip title={getI18nText('tooltip_previous_art')}>\n            <Button variant=\"outlined\" endIcon={<FiSend />} onClick={sharePrev}>\n              Share Previous Art\n            </Button>\n          </Tooltip>\n        </Space>\n      </Wraper>\n    </>\n  )\n}\n\nexport default Component\n\nconst FlexDiv = styled.div`\n  display: flex;\n  justify-content: center;\n`\n\nconst FlexCol = styled.div`\n  display: flex;\n  flex-direction: column;\n`\n\nconst StageDiv = styled.div`\n  background-color: #ffffff;\n`\nconst Wrap = styled.div`\n  width: 500px;\n  margin: 0px 32px;\n`\n\nconst CustomSketchPicker = styled(SketchPicker)({\n  marginTop: '10px',\n  marginLeft: '20px',\n})\n\nconst SBsPenFill = styled('div')<{\n  color: string\n}>`\n  background: ${(props) => props.color};\n  height: 4px;\n`\n\nconst Wraper = styled('div')`\n  display: flex;\n  justify-content: center;\n`\n","import Konva from 'konva'\nimport React from 'react'\nimport Canvas from '../../components/elements/Canvas'\n\nimport { getFile, saveFile } from '../../libs/Symbol/ImageIO'\n\nimport ShareModal from '../../components/elements/ShareModal'\n\nexport interface Props {\n  hash: string\n}\n\nconst Page: React.VFC<Props> = ({ hash }) => {\n  const [image, setImage] = React.useState<HTMLImageElement>(new Image())\n  const stageRef = React.useRef<Konva.Stage | null>(null)\n\n  const [open, setOpen] = React.useState(false)\n  const [openPM, setOpenPM] = React.useState(false)\n  const [txHash, setTxHash] = React.useState('')\n  const [isLoading, setIsLoading] = React.useState(true)\n  const [error, setError] = React.useState(false)\n\n  const save = () => {\n    if (stageRef.current === null) return\n    const img = stageRef.current.toDataURL()\n    console.log(img)\n    saveFile(img, 'draw-chain', hash).then((h) => setTxHash(h))\n    setOpen(true)\n  }\n  React.useEffect(() => {\n    if (hash === '') {\n      console.log('new game')\n      setIsLoading(false)\n      return\n    }\n    console.log('import:', hash)\n    getFile(hash)\n      .then((img) => {\n        setIsLoading(false)\n        const i = new Image()\n        i.src = img\n        setImage(i)\n      })\n      .catch(() => {\n        console.log('dame')\n        setError(true)\n      })\n  }, [hash])\n\n  if (error) {\n    return <div>NotFound This Transaction</div>\n  }\n\n  if (isLoading) {\n    return <div>GetTransaction....</div>\n  }\n\n  const sharePrev = () => {\n    setOpenPM(true)\n  }\n\n  return (\n    <div>\n      <Canvas\n        saveFile={save}\n        stageRef={stageRef}\n        image={image}\n        sharePrev={sharePrev}\n      />\n      <ShareModal open={open} setOpen={setOpen} txHash={txHash} />\n      <ShareModal open={openPM} setOpen={setOpenPM} txHash={hash} />\n    </div>\n  )\n}\n\nexport default Page\n","import React from \"react\"\nimport Page from \"./Presenter\"\nimport { useParams } from \"react-router-dom\"\n\nconst Container: React.VFC = () => {\n  const { hash } = useParams()\n  return <Page hash={hash || ''}/>\n}\n\nexport default Container\n","import {\n  Account,\n  AggregateTransaction,\n  Deadline,\n  NetworkType,\n  TransferTransaction,\n  UInt64,\n  RepositoryFactoryHttp,\n  PlainMessage,\n  TransactionGroup,\n  Transaction,\n  Address,\n} from 'symbol-sdk'\n\nconst G_HASH =\n  '7FCCD304802016BEBBCD342A332F91FF1F3BB5E902988B352697BE245F48E836'\nconst NODE = 'https://sym-test-01.opening-line.jp:3001'\nconst EPOCH = 1637848847\n\nconst master =\n  '891D9D7E9672925123CFB7766CE9AC740BAFED43AE78F64CE2D296F54E62E57A'\n\nexport const getFile = async (hash: string): Promise<string> => {\n  return new Promise((resolve, reject) => {\n    checkConfirmed(hash)\n      .then((tx) => {\n        if (tx instanceof TransferTransaction) {\n          const h: string = JSON.parse(tx.message.payload).data\n          resolve(innerTxJoin(h))\n        }\n      })\n      .catch(() => {\n        const timer = setInterval(() => {\n          checkUnConfirmed(hash)\n            .then(() => {\n              setTimeout(() => {\n                checkConfirmed(hash)\n                  .then((tx) => {\n                    clearInterval(timer)\n                    if (tx instanceof TransferTransaction) {\n                      const h: string = JSON.parse(tx.message.payload).data\n                      resolve(innerTxJoin(h))\n                    }\n                  })\n                  .catch(() => {\n                    reject('404')\n                  })\n              }, 1000)\n            })\n            .catch(() => {\n              console.log('loading')\n            })\n        }, 1000)\n      })\n  })\n}\nexport const getApostilleFile = async (hash: string): Promise<string> => {\n  const arr = []\n\n  new Promise((resolve, reject) => {\n    checkConfirmed(hash).then((tx) => {\n      if (tx instanceof TransferTransaction) {\n        console.log('data', JSON.parse(tx.message.payload))\n      }\n    })\n  })\n  return new Promise((resolve, reject) => {\n    checkConfirmed(hash)\n      .then((tx) => {\n        if (tx instanceof TransferTransaction) {\n          const h: string = JSON.parse(tx.message.payload).data\n          console.log(\n            'previous hash',\n            JSON.parse(tx.message.payload).previousHash\n          )\n          resolve([innerTxJoin(h), innerTxJoin(h)].join(','))\n        }\n      })\n      .catch(() => {\n        const timer = setInterval(() => {\n          checkUnConfirmed(hash)\n            .then(() => {\n              setTimeout(() => {\n                checkConfirmed(hash)\n                  .then((tx) => {\n                    clearInterval(timer)\n                    if (tx instanceof TransferTransaction) {\n                      const h: string = JSON.parse(tx.message.payload).data\n                      resolve([innerTxJoin(h), innerTxJoin(h)].join(','))\n                    }\n                  })\n                  .catch(() => {\n                    reject('404')\n                  })\n              }, 1000)\n            })\n            .catch(() => {\n              console.log('loading')\n            })\n        }, 1000)\n      })\n  })\n}\n\nconst checkUnConfirmed = (hash: string): Promise<void> => {\n  const repositoryFactory = new RepositoryFactoryHttp(NODE)\n  const transactionHttp = repositoryFactory.createTransactionRepository()\n  return new Promise((res, rej) => {\n    transactionHttp\n      .getTransaction(hash, TransactionGroup.Unconfirmed)\n      .toPromise()\n      .then(() => {\n        rej()\n      })\n      .catch(() => {\n        res()\n      })\n  })\n}\n\nconst checkConfirmed = (hash: string): Promise<Transaction> => {\n  const repositoryFactory = new RepositoryFactoryHttp(NODE)\n  const transactionHttp = repositoryFactory.createTransactionRepository()\n  return new Promise((res, rej) => {\n    transactionHttp\n      .getTransaction(hash, TransactionGroup.Confirmed)\n      .toPromise()\n      .then((tx: Transaction) => {\n        res(tx)\n      })\n      .catch(() => {\n        rej()\n      })\n  })\n}\nconst innerTxJoin = async (hash: string): Promise<string> => {\n  const repositoryFactory = new RepositoryFactoryHttp(NODE)\n  const transactionHttp = repositoryFactory.createTransactionRepository()\n  let data = ''\n\n  return new Promise((resolve) => {\n    transactionHttp\n      .getTransaction(hash, TransactionGroup.Confirmed)\n      .toPromise()\n      .then((agtx) => {\n        const innerTxs = (agtx as AggregateTransaction).innerTransactions\n        for (const inTx of innerTxs) {\n          data += (inTx as TransferTransaction).message.payload\n        }\n        resolve(data)\n      })\n  })\n}\n\nexport const saveFile = async (\n  base64img: string,\n  gameMode: string,\n  previousHash: string\n): Promise<string> => {\n  const signer = Account.createFromPrivateKey(master, NetworkType.TEST_NET)\n  const acc = Address.createFromRawAddress(\n    'TDEC5VUUAUYHKI2Y45WBDMGODAS42P3PPCTMGUY'\n  )\n  const array: string[] = []\n  const MSG_SIZE = 1023\n  for (let i = 0; i <= Math.floor(base64img.length / MSG_SIZE); i++) {\n    const arr = base64img.slice(i * MSG_SIZE, (i + 1) * MSG_SIZE)\n    array.push(arr)\n  }\n  // console.log('arr', array)\n\n  //===================================================\n\n  const txs = []\n  const agtxs = []\n  const hashes: string[] = []\n  //===================================================\n\n  const repositoryFactory = new RepositoryFactoryHttp(NODE)\n  const transactionHttp = repositoryFactory.createTransactionRepository()\n\n  for (let i = 0; i < array.length; i++) {\n    // console.log(\"row\", array[i]);\n    const inTx = TransferTransaction.create(\n      Deadline.create(EPOCH),\n      acc,\n      [],\n      PlainMessage.create(array[i]),\n      NetworkType.TEST_NET\n    ).toAggregate(signer.publicAccount)\n\n    txs.push(inTx)\n\n    if (i % 100 !== 99 && i !== array.length - 1) {\n      continue\n    }\n\n    const agtx = AggregateTransaction.createComplete(\n      Deadline.create(EPOCH),\n      txs,\n      NetworkType.TEST_NET,\n      [],\n      UInt64.fromUint(10000000)\n    )\n\n    const signedTx = signer.sign(agtx, G_HASH)\n\n    transactionHttp.announce(signedTx).subscribe(\n      (x) => console.log(x),\n      (err) => console.error(err)\n    )\n    agtxs.push(signedTx)\n    hashes.push(signedTx.hash)\n\n    console.log('a', signedTx)\n  }\n\n  return new Promise((resolve) => {\n    setTimeout(() => {\n      const data = JSON.stringify({\n        version: 1,\n        name: 'symbol-draw',\n        mode: gameMode,\n        previousHash: previousHash,\n        data: hashes.join(','),\n      })\n\n      const a = []\n      for (let i = 0; i <= Math.floor(data.length / MSG_SIZE); i++) {\n        a.push(data.substr(i * MSG_SIZE, MSG_SIZE))\n      }\n      const tx = TransferTransaction.create(\n        Deadline.create(EPOCH),\n        acc,\n        [],\n        PlainMessage.create(data),\n        NetworkType.TEST_NET,\n        UInt64.fromUint(2000000)\n      )\n\n      const st = signer.sign(tx, G_HASH)\n\n      transactionHttp.announce(st).subscribe(\n        (x) => console.log(x),\n        (err) => console.error(err)\n      )\n      resolve(st.hash)\n    }, 1000)\n  })\n}\n"],"sourceRoot":""}